(setf excl::*global-gc-behavior* :auto)
(sys:set-stack-cushion 150000000)

(format t "cla : ~A~%" (sys:command-line-argument-count))
(setf d-file (second (sys:command-line-arguments)))
(setf p-file (third (sys:command-line-arguments)))
(setf o-file (fourth (sys:command-line-arguments)))
;(setf use-heuristic (fifth (sys:command-line-arguments)))
(setf to-be-scrambled (fifth (sys:command-line-arguments)))
;(setf param (fourth (sys:command-line-arguments)))
;(setf param2 (fourth (sys:command-line-arguments)))
;(format t "num_packages is ~A ~%" num_packages)
(setf st (get-internal-run-time))

;(setf d-file "/home/svikas/research/code/GDP-test-data/hgn/logistics/domains/logistics-domain-hgn.lisp")
;(setf p-file "/home/svikas/research/code/GDP-test-data/hgn/logistics/problems/hgn-logistics-30-3.lisp")
;(setf o-file "test.out")

;(if (not (>= (sys:command-line-argument-count) 4))
;  (progn
;    (error "Not enough arguments to alisp. The command should be of the form ~%
;           'alisp -#! gnp-load.lisp <domain-file> <problem-file> <output-file>';.")))

(require :asdf)
(asdf:oos 'asdf:load-op :shop2)
(compile-file "gdp-utils.lisp")
(compile-file "gdp-funcs.lisp")
(compile-file "gdp-test.lisp")
(compile-file "gdp-decls.lisp")
(compile-file "gdp-search.lisp")
(compile-file "gdp-classical.lisp")
(compile-file "utils.lisp")
;(compile-file "basic-example-replanning.lisp")
(compile-file "ff-heuristic.lisp")
;(compile-file "experiments/hgn-domains/logistics-partial.lisp")
(compile-file d-file)
(compile-file p-file)
;(compile-file (concatenate 'string "examples/hgn/" domain "/domains/" domain "-hgn.lisp"))
;(compile-file (concatenate 'string "examples/hgn/" domain "/problems/hgn-" domain "-" param ".lisp"))

;(load "basic-example-replanning.lisp")
(load "gdp-utils.lisp")
(load "gdp-funcs.lisp")
(load "ff-heuristic.lisp")
(load "gdp-decls.lisp")
(load "gdp-search.lisp")
(load "gdp-classical.lisp")
(load "utils.lisp")
(load d-file)
(load p-file)
;(load "experiments/hgn-domains/logistics-partial.lisp")
;(load (concatenate 'string "examples/hgn/" domain "/domains/" domain "-hgn.lisp"))
;(load (concatenate 'string "examples/hgn/" domain "/problems/hgn-" domain "-" param ".lisp"))

#|
;(in-package :shop2)
(setf to-be-scrambled (fifth (sys:command-line-arguments)))
(setf o-file (fourth (sys:command-line-arguments)))

(let ((methods (shop2::domain-methods shop2::*domain*)))
  (if to-be-scrambled
    (maphash (lambda (name body)
               (setf (gethash name methods) (shop2::randomize-list body nil)))
             methods)))
|#
;(in-package :shop2)
(setf shop2::*hgn-output* o-file)
;(setf shop2::*use-heuristic* use-heuristic)
;(setf shop2::*scrambled* to-be-scrambled)

(load "gdp-test.lisp")

;(setf et (get-internal-run-time))
;(format t "~%job time is ~A ~%" (/ (float (- et st)) internal-time-units-per-second))
;(load "ron/domain.lisp")
;(load "ron/pfile_03.lisp")
;

; (maphash (lambda (key value) (format t "~A ----- ~A~%" key value)) (domain-axioms *domain*))
; (format t "~A~%" (gethash '!pickup (domain-methods *domain*)))

;(defun test-func (a b)
;  (+ a b))

;(format t "~A~%" (test-func 2 3))
