;;  This File tests the grammar and lexicon
;;


(defun test-sentence (sentence sa)
  (let ((ans (parse-sentence sentence)))
    (format t ".")
    (if (not (sa-match ans sa))
	(Format t "~% Bad Parse for ~S~%      Answer returned was ~S~%" sentence ans))))

(defun sa-match (ans ref)
  (if (symbolp ref)
      (eq (car ans) ref)))

(defun parse-sentence (x)
  (parse :user 'text '(start))
  (parse :user 'text (list 'word x))
  (parse :user 'text '(return)))


(Format t "Starting Test of grammar")

(defun runtest nil
  (test-sentence "will the train arrive at 5:30" 'SA-YN-QUESTION)
  (test-sentence "There are oranges at Corning" 'SA-TELL)
  (test-sentence "Is there a train in Boston" 'SA-YN-QUESTION)
  (test-sentence "From Avon to Bath" 'SPEECH-ACT)
  (test-sentence "Is the engine coming from Corning?" 'SA-YN-QUESTION)
  (test-sentence "The engine is coming from Corning?" 'SA-YN-QUESTION)
  (test-sentence "The boxcar?" 'SA-YN-QUESTION)
  (test-sentence "From Avon to Corning?" 'SA-YN-QUESTION)
  (test-sentence "I'm done" 'SA-CLOSE)
  (test-sentence "I'm done, please" 'SA-CLOSE)
  (test-sentence "Hello" 'SA-GREET)
  (test-sentence "How about from Avon to Corning?" 'SA-SUGGEST)
  (test-sentence "Why would that route be faster" 'SA-WHY-QUESTION)
  (test-sentence "Why not three boxcars of oranges?" 'SA-WHY-QUESTION)
  (test-sentence "When will the engine arrive at Dansville" 'SA-WH-QUESTION)
  (test-sentence "When" 'SA-WH-QUESTION)
  (test-sentence "What engine did we send to Bath" 'SA-WH-QUESTION)
  (test-sentence "The boxcar is at bath" 'SA-TELL)
  (test-sentence "At what time will the train arrive" 'SA-WH-QUESTION)
  (test-sentence "Where is the train going" 'SA-WH-QUESTION)
  (test-sentence "We sent the boxcar where" 'SA-WH-QUESTION)
  (test-sentence "The train that went to Corning arrived" 'SA-TELL)
  (test-sentence "The train is late" 'SA-TELL)
  (test-sentence "Avon is a city" 'SA-TELL)
  (test-sentence "The engine is in Dansville" 'SA-TELL)
  (test-sentence "Is the train arriving at 5:30" 'SA-YN-QUESTION)
  (test-sentence "Will the train arrive tomorrow" 'SA-YN-QUESTION)
  (test-sentence "Is the engine at Chicago" 'SA-YN-QUESTION)
  (test-sentence "Was the train late?" 'SA-YN-QUESTION)
  (test-sentence "Is New york a city" 'SA-YN-QUESTION)
  (test-sentence "Can we load up the oranges" 'SA-YN-QUESTION)
  (test-sentence "The engine was taken to Bath" 'SA-TELL)
  (test-sentence "Tell him to go to avon" 'SA-REQUEST)
  (test-sentence "Go to avon instead" 'SA-REJECT)
  (test-sentence "That's OK" 'SA-EVALUATION)
  (test-sentence "OK" 'SA-CONFIRM)
  (test-sentence "Maybe" 'SA-RESPONSE)
  (test-sentence "Who did you see in the train?" 'SA-WH-QUESTION)
  (test-sentence "They went to avon maybe" 'SA-TELL)
  (test-sentence "From Chicago, go to Toronto via Detroit" 'SA-REQUEST)
  (test-sentence "In Chicago, the train arrived" 'SA-TELL)
  (test-sentence "The train is not in Chicago" 'SA-TELL)
  (test-sentence "Don't go through Toronto" 'SA-REQUEST)
  (test-sentence "Tell me the plan" 'SA-REQUEST)
  (test-sentence "Let's go to bath" 'SA-REQUEST)
  (test-sentence "Have the train sent to avon" 'SA-REQUEST)
  (test-sentence "The train was sent from bath" 'SA-TELL)
  (test-sentence "Let's get the train to bath" 'SA-REQUEST)
  (test-sentence "When does the train get to bath" 'SA-WH-QUESTION)
  (test-sentence "will the train arrive at 5:30" 'SA-YN-QUESTION)
(test-sentence "how about columbus to raleigh" 'SA-SUGGEST)
(test-sentence "how far is it from avon to bath" 'SA-WH-QUESTION)
(test-sentence "highlight the trains" 'SA-REQUEST)
(test-sentence "show me the trains" 'SA-REQUEST)

(test-sentence "where else do i need to go" 'SA-WH-QUESTION)
(test-sentence "where is the train that went to avon" 'SA-WH-QUESTION)
(test-sentence "I believe that the train is late" 'SA-TELL)
(test-sentence "what is the shortest route from avon to bath" 'SA-WH-QUESTION)
(test-sentence "what should i do now" 'SA-WH-QUESTION)
(test-sentence "how do I move the trains around" 'SA-HOW-QUESTION)
(test-sentence "how many trains are at avon" 'SA-WH-QUESTION)

(test-sentence "what's the distance between syracuse and pittsburgh" 'SA-WH-QUESTION)


(test-sentence "go to to avon" 'SA-request)
(test-sentence "I want to go to Avon and" 'SA-ID-GOAL)
(test-sentence "cancel the whole route" 'SA-REQUEST)
(test-sentence "show me the trains" 'SA-REQUEST)

(test-sentence "i'm done" 'SA-CLOSE)
(test-sentence "is there a faster route" 'SA-YN-QUESTION)
(test-sentence "go to bath via the shortest route" 'SA-REQUEST)
(test-sentence "Is there a faster route" 'SA-YN-QUESTION)
(test-sentence "Is there a faster route than that" 'SA-YN-QUESTION)
(test-sentence "What about going through avon and bath instead" 'SA-REJECT)
(test-sentence "What supplies are in Baltimore" 'SA-WH-QUESTION)
(test-sentence "Are the goods loaded" 'SA-YN-QUESTION)
(test-sentence "Will the snowstorm stop soon" 'SA-YN-QUESTION)
(test-sentence "How much will that cost" 'SA-WH-QUESTION)
(test-sentence "I have how much money" 'SA-WH-QUESTION)
(test-sentence "Is there a delay involved" 'SA-YN-QUESTION)
(test-sentence "WHAT DID YOU SAY" 'SA-WH-QUESTION)
(test-sentence  "how long will it take to get to avon" 'sa-wh-question)
(test-sentence "how much time will it take" 'sa-wh-question)
(test-sentence "how long will it take for the train to arrive" 'sa-wh-question)
(test-sentence "how long is that route" 'sa-wh-question)
(test-sentence "what is the cost to travel from avon to bath" 'sa-wh-question)
(test-sentence "The distance of the route is seven miles" 'sa-tell)
(test-sentence "The route is seven miles long" 'sa-tell)
(test-sentence "The route is how long" 'sa-wh-question)
(test-sentence "What train do i need to see" 'sa-wh-question)
(test-sentence  "this is the train which is currently at Philly" 'sa-tell)
(test-sentence  "show me how to get to avon" 'sa-request)
(test-sentence  "he asked me what to do" 'sa-tell)
(test-sentence "is it fast to go through avon" 'sa-yn-question)
(test-sentence "It is fastest to go through avon" 'sa-tell)
(test-sentence "Is it faster to go through Avon instead of Bath" 'sa-yn-question)

  (format t "Test completed"))

(runtest)
